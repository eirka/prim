<div class="postbox" ng-controller="IndexFormCtrl as postform">
    <div class="postbox_box">
        <div class="postbox_form">
            <form role="form" action="{{postform.getFormAction('/post/thread/new')}}" method="post" enctype="multipart/form-data">
                <input type="hidden" name="ib" ng-value="index.ib_id" />
                <input type="hidden" name="askey" ng-value="index.as_key" />
                <input ng-if="authState.isAuthenticated" type="hidden" name="access_token" ng-value="postform.token" />
                <div class="form-group">
                    <span ng-bind="::authState.name" class="form-control" ng-class="index.usergroupClass(authState.group)"></span>
                </div>
                <div class="form-group">
                    <input type="text" id="title" ng-required="true" name="title" class="form-control" ng-maxlength="40" placeholder="Title">
                </div>
                <div class="form-group">
                    <textarea id="comment" name="comment" ng-required="true" class="form-control" rows="3" ng-maxlength="1000" placeholder="Comment"></textarea>
                </div>
                <div class="form-group">
                    <input id="file" type="file" name="file">
                </div>
                <div class="form-group">
                    <button class="button button-block button-primary" type="submit" value="Submit">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="threads">
    <div ng-repeat="thread in index.data track by thread.id" id="thread-{{::thread.id}}" class="thread">
        <div class="thread_index_header">
            <div class="thread_title">
                <span ng-bind="::thread.title"></span>
                <i ng-if="thread.closed" title="Closed" class="fa fa-lock"></i>
                <i ng-if="thread.sticky" title="Sticky" class="fa fa-thumb-tack"></i>
            </div>
            <div class="thread_buttons">
                <a class="button button-default" ng-href="thread/{{::thread.id}}/{{::thread.last_page}}" href>Reply</a>
            </div>
        </div>
        <div class="thread_row_header">
            <div class="thread_row_image" ng-if="thread.posts[0].thumbnail != null">
                <a ng-href="image/{{::thread.posts[0].img_id}}" href>
                    <img ng-src="{{::index.thumb(thread.posts[0].thumbnail)}}" height="{{::thread.posts[0].tn_height}}" width="{{::thread.posts[0].tn_width}}"> </a>
            </div>
            <div class="thread_row_info">
                <span class="post_info" ng-class="index.usergroupClass(thread.posts[0].group)" ng-bind="::thread.posts[0].name"></span>
                <span class="post_info" ng-bind="::thread.posts[0].time"></span>
                <a class="label label-dark" ng-bind="'#'+{{::thread.posts[0].num}}" ng-click="index.replyQuote(thread.posts[0].num,thread.id,thread.last_page)" href></a>
            </div>
            <div comment-handler post="::thread.posts[0]" thread="thread.id"></div>
        </div>
        <div class="thread_row_header">
            <div class="thread_row_omit" ng-if="!!thread.omit_posts">
                {{ ::thread.omit_posts }} posts omitted. Click <a ng-href="thread/{{::thread.id}}/{{::thread.last_page}}" href>Reply</a> to view.
            </div>
        </div>
        <div ng-repeat="post in thread.posts track by post.id" ng-if="!$first" class="thread_row">
            <div class="thread_row_image" ng-if="!!post.thumbnail">
                <a ng-href="image/{{::post.img_id}}" href><img ng-src="{{::index.thumb(post.thumbnail)}}" height="{{::post.tn_height}}" width="{{::post.tn_width}}"> </a>
            </div>
            <div class="thread_row_info">
                <span class="post_info" ng-class="index.usergroupClass(post.group)" ng-bind="::post.name"></span>
                <span class="post_info" ng-bind="::post.time"></span>
                <a class="label label-light" ng-bind="'#'+{{::post.num}}" ng-click="index.replyQuote(post.num,thread.id,thread.last_page)" href></a>
            </div>
            <div comment-handler post="post" thread="thread.id"></div>
        </div>
    </div>
</div>
<div class="footer">
    <div class="footer_box">
        <pagination boundary-links="true" rotate="true" direction-links="false" page-name="page" total-items="index.pagination.totalItems" max-size="index.pagination.maxSize" ng-model="index.pagination.currentPage" items-per-page="index.pagination.itemsPerPage" num-pages="index.pagination.numPages">
    </div>
</div>
